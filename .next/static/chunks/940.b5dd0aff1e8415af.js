"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[940],{940:function(e,r,t){t.r(r);var s=t(7437),l=t(6648),n=t(2265),a=t(5590);let o=["a","b","c","d","e","f","g","h"],c=["8","7","6","5","4","3","2","1"];r.default=e=>{let{opening:r,isDark:t,showCoords:i,animationEnabled:d,animationDelay:u,soundEnabled:m,soundVolume:g,sidebarWidth:b,onSidebarWidthChange:f,children:h,rightSidebarWidth:v,onRightSidebarWidthChange:x}=e,p=(e,r)=>"".concat(o[r]).concat(8-e),w=e=>Array.from(e.values()).map(e=>({...e})),k=(0,n.useCallback)(e=>{let r={},t=new Map;return e.board().forEach((e,s)=>{e.forEach((e,l)=>{if(!e)return;let n="".concat(e.color).concat(e.type);r[n]=(r[n]||0)+1;let a="".concat(n,"-").concat(r[n]),o=p(s,l);t.set(a,{id:a,color:e.color,type:e.type,square:o})})}),t},[]),y=(0,n.useCallback)((e,r)=>{let t=new Map(e);if(r.captured){let e=r.to;if(r.flags.includes("e")){let t=r.to[0],s=Number(r.to[1]),l="w"===r.color?s-1:s+1;e="".concat(t).concat(l)}for(let[r,s]of Array.from(t.entries()))if(s.square===e){t.delete(r);break}}let s=null;for(let[e,l]of Array.from(t.entries()))if(l.square===r.from&&l.color===r.color){s=e;break}if(s){let e=t.get(s);if(e){var l;t.set(s,{...e,square:r.to,type:null!==(l=r.promotion)&&void 0!==l?l:e.type})}}if(r.flags.includes("k")||r.flags.includes("q")){let e="w"===r.color,s=r.flags.includes("k"),l=e?s?"h1":"a1":s?"h8":"a8",n=e?s?"f1":"d1":s?"f8":"d8";for(let[e,s]of Array.from(t.entries()))if(s.square===l&&"r"===s.type&&s.color===r.color){t.set(e,{...s,square:n});break}}return t},[]),[N,j]=(0,n.useState)(()=>new a.qQ().fen()),[E,z]=(0,n.useState)(()=>w(k(new a.qQ))),[q,M]=(0,n.useState)(-1),C=(0,n.useRef)(null),A=(0,n.useRef)(null),L=(0,n.useRef)(null),R=(0,n.useRef)(null),T=(0,n.useRef)(null),D=(0,n.useRef)(null),S=(0,n.useRef)(null),_=(0,n.useRef)(null),Q="#FFCE9E",X="#D18B47",I=e=>["a","c","e","g"].includes(e)?Q:X,H=e=>["2","4","6","8"].includes(e)?Q:X,P=e=>{let r=e[0],t=Number(e[1]),s=o.indexOf(r);return{left:"".concat(s/8*100,"%"),top:"".concat((8-t)/8*100,"%")}},F=(0,n.useMemo)(()=>({wp:{src:"/images/whitepawn.svg"},wn:{src:"/images/whiteknight.svg"},wb:{src:"/images/whitebishop.svg"},wr:{src:"/images/whiterook.svg"},wq:{src:"/images/whitequeen.svg"},wk:{src:"/images/whiteking.svg"},bp:{src:"/images/blackpawn.svg"},bn:{src:"/images/blackknight.svg"},bb:{src:"/images/blackbishop.svg"},br:{src:"/images/blackrook.svg"},bq:{src:"/images/blackqueen.svg"},bk:{src:"/images/blackking.svg"}}),[]),B=(0,n.useMemo)(()=>r.moves.split(/\s+/).filter(e=>e.trim().length>0),[r.moves]),O=(0,n.useMemo)(()=>{let e=new a.qQ,r=k(e),t=[{fen:e.fen(),pieces:w(r)}];return B.forEach(s=>{try{let l=e.move(s);l&&(r=y(r,l),t.push({fen:e.fen(),pieces:w(r)}))}catch(e){console.warn("Chess logic error:",e)}}),t},[y,k,B]),U=(0,n.useMemo)(()=>{let e=new a.qQ,r=()=>"function"==typeof e.inCheck?e.inCheck():"function"==typeof e.in_check&&e.in_check();return B.map(t=>{let s=e.move(t);return{isCapture:!!(null==s?void 0:s.captured),isCastle:!!s&&(s.flags.includes("k")||s.flags.includes("q")),isCheck:!!s&&r()}})},[B]);(0,n.useEffect)(()=>{let e=Math.min(O.length-1,Math.max(0,q+1)),r=O[e];j(r.fen),z(r.pieces)},[q,O]);let W=(0,n.useCallback)(()=>{null!==R.current&&(clearInterval(R.current),R.current=null)},[]);(0,n.useEffect)(()=>{if(M(-1),W(),!d||0===B.length){M(B.length-1);return}let e=window.setInterval(()=>{M(e=>{let r=e+1;return r>=B.length?(W(),e):r})},u);return R.current=e,()=>{W()}},[u,d,B.length,r,W]),(0,n.useEffect)(()=>{if(!C.current)return;let e=C.current.querySelector('[data-active-move="true"]');if(!e)return;let r=C.current,t=e.offsetTop,s=t+e.offsetHeight;t<r.scrollTop?r.scrollTop=t-8:s>r.scrollTop+r.clientHeight&&(r.scrollTop=s-r.clientHeight+8)},[q,B.length]);let G=(0,n.useCallback)(e=>{W(),M(r=>Math.max(-1,Math.min(B.length-1,r+e)))},[B.length,W]);(0,n.useEffect)(()=>(T.current=new Audio("/sounds/move.mp3"),D.current=new Audio("/sounds/capture.mp3"),S.current=new Audio("/sounds/castle.mp3"),_.current=new Audio("/sounds/check.mp3"),[T,D,S,_].forEach(e=>{e.current&&(e.current.volume=g)}),()=>{T.current=null,D.current=null,S.current=null,_.current=null}),[g]),(0,n.useEffect)(()=>{if(!m||q<0)return;let e=U[q],r=(null==e?void 0:e.isCastle)?S.current:(null==e?void 0:e.isCheck)?_.current:(null==e?void 0:e.isCapture)?D.current:T.current;r&&(r.currentTime=0,r.volume=g,r.play().catch(()=>null))},[q,U,m,g]),(0,n.useEffect)(()=>{let e=e=>{if("ArrowLeft"!==e.key&&"ArrowRight"!==e.key)return;let r=e.target;r&&("INPUT"===r.tagName||"TEXTAREA"===r.tagName||r.isContentEditable)||(e.preventDefault(),G("ArrowLeft"===e.key?-1:1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[G]);let J=(0,n.useMemo)(()=>{let e=new a.qQ;return e.load(N),e.board()},[N]);return(0,s.jsxs)("div",{className:"flex flex-col xl:flex-row items-start gap-0 bg-white/60 dark:bg-black/20 p-5 rounded-2xl backdrop-blur-sm shadow-md border border-gray-100 dark:border-white/5 overflow-hidden",style:{"--board-size":"clamp(320px, 70vw, 640px)"},children:[(0,s.jsx)("div",{className:"w-full md:w-auto shrink-0",style:{width:"var(--board-size)"},children:(0,s.jsxs)("div",{className:"relative aspect-square shadow-2xl rounded-2xl overflow-hidden border-4 ".concat(t?"border-gray-600":"border-gray-800"),children:[(0,s.jsx)("div",{className:"grid grid-cols-8 grid-rows-8 w-full h-full",children:J.map((e,r)=>e.map((e,t)=>{let l=(r+t)%2==0;return(0,s.jsxs)("div",{className:"relative w-full h-full",style:{backgroundImage:"url(".concat(l?"/images/lightsquare.svg":"/images/darksquare.svg",")"),backgroundSize:"cover",backgroundPosition:"center"},children:[i&&7===r&&(0,s.jsx)("span",{className:"absolute bottom-1 left-1 text-[10px] font-black",style:{color:I(o[t])},children:o[t]}),i&&7===t&&(0,s.jsx)("span",{className:"absolute top-1 right-1 text-[10px] font-black",style:{color:H(c[r])},children:c[r]})]},"".concat(r,"-").concat(t))}))}),(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:E.map(e=>{let r=P(e.square),t=F["".concat(e.color).concat(e.type)];return(null==t?void 0:t.src)?(0,s.jsx)("div",{className:"absolute",style:{left:r.left,top:r.top,width:"12.5%",height:"12.5%",transition:d?"left 0.3s ease, top 0.3s ease":"none"},children:(0,s.jsx)(l.default,{src:t.src,alt:"".concat(e.color).concat(e.type),fill:!0,sizes:"(max-width: 640px) 60px, 80px",className:"object-contain select-none pointer-events-none",draggable:!1})},e.id):null})})]})}),(0,s.jsx)("div",{className:"hidden xl:flex w-4 cursor-ew-resize items-center justify-center hover:bg-blue-500/10 transition-colors self-stretch shrink-0",onMouseDown:e=>{e.preventDefault();let r=e.clientX,t=e=>{f(Math.max(220,Math.min(520,b-(e.clientX-r))))},s=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s),document.body.style.cursor=""};document.addEventListener("mousemove",t),document.addEventListener("mouseup",s),document.body.style.cursor="ew-resize"},children:(0,s.jsx)("div",{className:"w-1 h-12 bg-gray-300 dark:bg-zinc-600 rounded-full"})}),(0,s.jsxs)("div",{ref:A,className:"w-full xl:w-auto bg-white dark:bg-zinc-800 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-700 flex flex-col overflow-hidden shrink-0 mt-6 xl:mt-0",style:{height:"var(--board-size)",width:"".concat(b,"px")},children:[(0,s.jsx)("div",{className:"p-3 bg-gray-100 dark:bg-zinc-700/50 border-b border-gray-200 dark:border-zinc-700",children:(0,s.jsxs)("h3",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider flex items-center gap-2",children:[(0,s.jsx)("span",{children:"â™Ÿ"})," Moves"]})}),(0,s.jsxs)("div",{ref:C,className:"flex-1 overflow-y-auto p-3 custom-scrollbar no-scrollbar relative bg-gray-50 dark:bg-zinc-900/50",children:[(0,s.jsx)("table",{className:"w-full text-sm border-collapse",children:(0,s.jsx)("tbody",{children:Array.from({length:Math.ceil(B.length/2)}).map((e,r)=>{let t=2*r,l=2*r+1,n=B[t],a=B[l],o=q===t,c=q===l,i="py-1.5 px-2 font-medium text-gray-800 dark:text-gray-200 rounded-md transition-colors",d="bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300";return(0,s.jsxs)("tr",{className:"border-b border-gray-100 dark:border-zinc-700/30 last:border-0 hover:bg-gray-100 dark:hover:bg-zinc-800/50 transition-colors",children:[(0,s.jsxs)("td",{className:"py-1.5 px-2 text-gray-400 font-mono text-xs w-8 select-none",children:[r+1,"."]}),(0,s.jsx)("td",{"data-active-move":o?"true":void 0,className:"".concat(i," ").concat(o?d:""),children:n||""}),(0,s.jsx)("td",{"data-active-move":c?"true":void 0,className:"".concat(i," ").concat(c?d:""),children:a||""})]},r)})})}),0===B.length&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400 text-xs italic",children:"Waiting for start..."})]}),(0,s.jsxs)("div",{className:"p-3 border-t border-gray-200 dark:border-zinc-700 bg-gray-100 dark:bg-zinc-800/60 flex items-center gap-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>G(-1),disabled:q<=-1,className:"px-3 py-1.5 rounded-lg text-sm font-semibold bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-zinc-800 disabled:opacity-40 disabled:cursor-not-allowed",children:"< Prev"}),(0,s.jsx)("div",{className:"flex-1 text-center text-xs text-gray-500 dark:text-gray-400",children:0===B.length?"No moves":q>=0?"Move ".concat(q+1," / ").concat(B.length):"Start position"}),(0,s.jsx)("button",{type:"button",onClick:()=>G(1),disabled:q>=B.length-1,className:"px-3 py-1.5 rounded-lg text-sm font-semibold bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-zinc-800 disabled:opacity-40 disabled:cursor-not-allowed",children:"Next >"})]})]}),(0,s.jsx)("div",{className:"hidden xl:flex w-4 cursor-ew-resize items-center justify-center hover:bg-blue-500/10 transition-colors self-stretch shrink-0",onMouseDown:e=>{e.preventDefault();let r=e.clientX,t=e=>{x(Math.max(280,Math.min(600,v-(e.clientX-r))))},s=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s),document.body.style.cursor=""};document.addEventListener("mousemove",t),document.addEventListener("mouseup",s),document.body.style.cursor="ew-resize"},children:(0,s.jsx)("div",{className:"w-1 h-12 bg-gray-300 dark:bg-zinc-600 rounded-full"})}),(0,s.jsx)("div",{ref:L,className:"w-full xl:w-auto shrink-0 mt-6 xl:mt-0",style:{width:"".concat(v,"px")},children:h})]})}}}]);